Power Automate Hands On
---


# 当ハンズオンで行うこと

当ハンズオンでは、Power Automate を使用して、撮影した写真の顔から様々な情報を取得するフローを作成しています。

# 事前に必要なもの

* Power Automate をインストール可能なスマートフォン
* Microsoft アカウント

# 目次



# 1. 環境準備/ログイン

Power Automate を使用するための環境を準備します。

Microsoft 365 や Power Automate 有償プランを会社でお持ちの方はそちらを利用して頂いても構いませんが、個人で自由に利用できるためのプランとして、コミュニティプランというものがありますので、是非そちらもお使いください。<br>
有償プラン ※1 と同等の機能を無償でお使い頂けます。

※1：RPA機能（UI Flows/WinAutomation）は使用できません。

## 1.1 Microsoft 365 developer program への参加

* 既に Microsoft 365 アカウントをお持ちの方はこの内容をスキップしてください。

1. Microsoft 365 Developer プログラムのサイトにアクセスします。

[Microsoft 365 Developer プログラム](https://developer.microsoft.com/ja-jp/microsoft-365/dev-program)

2. 参加するをクリックします。

![](pasteimage/2020-09-30-00-57-46.png)

3. Microsoft アカウントでサインインします。

![](pasteimage/2020-09-30-00-59-51.png)

4. 国名と会社名と言語設定をそれぞれ指定し、次へをクリックします。

![](pasteimage/2020-09-30-01-01-22.png)

![](pasteimage/2020-09-30-01-02-52.png)

5. 該当するものにチェックを入れて、参加をクリックします。

![](pasteimage/2020-09-30-01-04-39.png)

6. E5 サブスクリプションのセットアップをクリックします。

![](pasteimage/2020-09-30-01-05-43.png)

7. 適宜任意のものを入れていき、続行をクリックします。

![](pasteimage/2020-09-30-01-07-28.png)

* ドメインについては全世界で一意（既にあるものは使えない）ですので、ドメインで赤枠が表示された場合は、別の名前にするなどして対処しましょう！

8. SMS使用可能な電話番号を入力し、コードの送信をクリックします。

![](pasteimage/2020-09-30-01-08-26.png)

9. SMSにワンタイムパスワードが送られたら、コードを入力しセットアップをクリックします。

![](pasteimage/2020-09-30-01-10-12.png)

10. サブスクリプションに移動するをクリックします。

![](pasteimage/2020-09-30-01-11-15.png)

11. 作成したアカウントのパスワードでサインインします。

![](pasteimage/2020-09-30-01-11-51.png)

12. 管理をクリックします。

![](pasteimage/2020-09-30-01-14-19.png)

13. Microsoft 365 のアカウントをクリックします。

![](pasteimage/2020-09-30-01-14-59.png)

14. ユーザーを展開し、アクティブなユーザーをクリックします。

![](pasteimage/2020-09-30-01-15-52.png)

15. アカウントを選択し、製品ライセンスの管理をクリックします。

![](pasteimage/2020-09-30-01-17-30.png)

16. ライセンスにチェックが入っていることを確認し、変更の保存をクリックします。

![](pasteimage/2020-09-30-01-18-23.png)

# 2. SharePoint サイトの作成

勤怠報告のデータを格納するリストを格納するための SharePoint サイトを作成します。

1. 画面右上のアプリ起動ツールをクリックする

![](pasteimage/2020-11-27-02-18-24.png)

2. SharePoint をクリックする

![](pasteimage/2020-11-27-02-19-19.png)

3. サイトの作成をクリックする

![](pasteimage/2020-11-27-02-20-15.png)

4. チーム サイト をクリックする

![](pasteimage/2020-11-27-02-21-07.png)

5. 任意のサイト名を入力を入力後、表示される項目を適宜入力

![](pasteimage/2020-11-27-02-21-42.png)

![](pasteimage/2020-11-27-02-22-52.png)

6. 言語を日本語に変更し、次へをクリックする

![](pasteimage/2020-11-27-02-23-44.png)

7. 作成を待って、完了をクリックする

![](pasteimage/2020-11-27-02-24-31.png)

8. このような画面に遷移すれば、SharePointサイトの作成は完了。

![](pasteimage/2020-11-27-02-25-10.png)

9. 画面右上のフォローをクリックし、作成したサイトをフォローする

![](pasteimage/2020-11-27-02-31-28.png)

![](pasteimage/2020-11-27-02-31-46.png)

# 3. リスト の作成

今度は、勤怠報告データを格納するリストを作成します。

1. サイトコンテンツをクリックする

![](pasteimage/2020-11-27-03-34-35.png)

2. 新規からリストをクリックする

![](pasteimage/2020-11-27-03-35-11.png)

3. 空白のリストをクリックする

![](pasteimage/2020-11-27-03-35-46.png)

6. 任意のリスト名を入力し作成をクリックする

![](pasteimage/2020-11-27-03-37-07.png)

# 4. リストの列定義を設定

列定義を以下のように設定します

|列名|種類|必須|選択値|既定値|
|:--|:--|:--|:--|:--|
|Full_Name|1行テキスト|True|||
|Work_Status|選択肢|True|出勤・休憩開始・休憩完了・退勤|出勤|
|Latitude|1行テキスト|True|||
|Longitude|1行テキスト|True|||
|Add_Day|1行テキスト|True|||

1. 設定からリストの設定をクリックする

![](pasteimage/2020-11-27-03-49-37.png)

2. title をクリックする

![](pasteimage/2020-11-27-03-50-15.png)

3. 列名を Full_Name に変更し、OKをクリックする

![](pasteimage/2020-11-27-03-51-22.png)

4. 列の作成をクリックする

![](pasteimage/2020-11-27-03-51-59.png)

5. Work_status は選択肢を選択し、必須項目とした後、選択項目を入力後、OKをクリックする

![](pasteimage/2020-11-27-03-54-52.png)

6. 同様に、Latitude Longtitude Add_day の列を作成する

![](pasteimage/2020-11-27-04-32-51.png)

# 5. Power Automate フローの作成

`これよりPower Automate側のフローを作成していきます

1. 画面右上のアプリ起動ツールをクリックする

![](pasteimage/2020-11-27-02-18-24.png)

2. Power Automate をクリックする

![](pasteimage/2020-11-27-03-59-01.png)

3. マイフローをクリックする

![](pasteimage/2020-11-27-04-00-43.png)

4. インスタントー一から作成をクリックする

![](pasteimage/2020-11-27-04-01-25.png)

5. フロー名を入力し、手動でフローをトリガーしますをクリックし、作成をクリックする

![](pasteimage/2020-11-27-04-02-33.png)

6. 新しいステップをクリックする

![](pasteimage/2020-11-27-04-04-12.png)

7. SharePoint をクリックする

![](pasteimage/2020-11-27-04-05-10.png)

8. 項目の作成 をクリックする

![](pasteimage/2020-11-27-04-05-51.png)

9. 作成したサイトを選択する

![](pasteimage/2020-11-27-04-07-15.png)

10. 作成したリストを選択する

![](pasteimage/2020-11-27-04-08-02.png)

11. Full_Name に トリガーのユーザー名を指定する

![](pasteimage/2020-11-27-04-09-13.png)

12. Latitude に緯度、Longtitude に経度を指定する

![](pasteimage/2020-11-27-04-34-54.png)

19. Add_Day には 日付 を指定する

![](pasteimage/2020-11-27-04-35-20.png)

20. ボタントリガーの設定をクリックする

![](pasteimage/2020-11-27-10-54-30.png)

21. 赤枠で示したいづれかのトグルスイッチをオンオフし、完了をクリックする

![](pasteimage/2020-11-27-10-55-33.png)


